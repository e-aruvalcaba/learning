window.start=this;var termino=!1;var bloqueoSiguiente=!1;var banderillas=!1;var Rutas=new Array();var Pag=new Array();var PagTotal=0;var currentPagina=0;var TRAK=new Array();var NombreModulos=new Array();var Modulos=new Array();var menu_open=!1;var bussy=!1;var fullscreen=!1;var Total;var TRAKtmp=new Array();var Evals=new Array();var EvalID=99;var EvalInProgress=!1;var ULTIMO=0;var Avance=0;var ONLINE=!1;var xmlGlosario="xml/glosario.xml"
var IDActual=0;var URLactual=window.location;var obj;var _root=window.parent;var timeline=0;var contador=0;var canvasContenido;var estadoMenu=!1;var terminado=!1;var LastMCVid=!1;var VidLast=!1;var estadoSim=!1;var iOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;var SCORE;var OS;var visibleSim;var visibleVid;var oportunidades=0;var intentoAct=0;var califMinima=0;var validar_control;var validar_shift;var backdoor=!1;var clave_backdoor="123";var clave_TerminarTema="qwe";var clave_eval="asd";var clave_borrar="zxc";var Glosario_gpo=new Array();var Glosario_pal=new Array();var Glosario_desc=new Array();var pagActual=0;var numPags=0;var controlAtras=!1;var NumPreguntas=0;var checkboxText="";var controlEvalArray=0;var controlIrUltimo=!1;var contControlCheckbox=0;var btnAtras;var btnSiguiente;var btnMenu;var btnEval;var btnHome;var btnCerrar;var EdoBtns={btnAtras:!0,btnSiguiente:!0,btnMenu:!0,btnEval:!0,btnCerrar:!0,btnHome:!0,barra:!0};var Temaslibre=!1;var btnArray=[];var libre=!1;var tl=new TimelineMax();var debug=!1;var myVar=setInterval(myTimer,20);window.onresize=function(){let maxHeight=window.screen.height,maxWidth=window.screen.width,curHeight=window.innerHeight,curWidth=window.innerWidth;if(maxWidth==curWidth&&maxHeight>=(curHeight-10)&&maxHeight<=(curHeight+10)){fullscreen=!0}else{fullscreen=!1}
if(fullscreen){fullscreen=!0;$(".contenedor").css("width","100%")}else{fullscreen=!1;$(".contenedor").css("width","75%")}
if(debug){console.log("--------------------------------------");console.log($("#menuHTML").height())}
var design=80;if(getBrowserInfo().split(" ")[0]=="IE"){design=95}
$("#menuHTML").height($("#div_contenido").height()-30);$("#temasContainer").height($("#menuHTML").height()-design);$("#barraInferior").width($("#div_contenido").width());$("#mensajesHTML").width($("#div_contenido").width());$("#ultimoContainer").width($("#div_contenido").width());let h=Math.max(document.documentElement.clientHeight,window.innerHeight||0);let diff=h-$("#content").height();$("#content").css("margin-top",(((diff/2)).toString()+"px"))}
function detectarMovil(){var check=!1;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check=!0})(navigator.userAgent||navigator.vendor||window.opera);return check};function alertas(tipo,texto){switch(tipo){case 1:texto=texto===""||texto===null||texto===undefined||texto===NaN?"Actividad Completada. Presione Siguiente para continuar...":texto;mostrarSiguiente(texto);break;case 2:texto=texto===""||texto===null||texto===undefined||texto===NaN?"Tema Completado. Presione Siguiente para continuar...":texto;mostrarTemaCompletado(texto);break}}
function inicializaMensajes(){tl=new TimelineMax({repeat:0,onComplete:stopAlertas});tl.from($("#mensajesHTML"),1,{opacity:0,left:'400px'})
tl.to($("#mensajesHTML"),1,{opacity:0,left:'400px',delay:5});$("#div_contenido").css("min-width","800px");$("#temasContainer").css("padding-bottom","36px")}
function stopAlertas(){tl.pause()
if($("#alertasContainer").hasClass("siguiente")){$("#alertasContainer").removeClass("siguiente")}
if($("#alertasContainer").hasClass("completado")){$("#alertasContainer").removeClass("completado")}
$("#mensajesHTML").css("display","none")}
function mostrarSiguiente(texto){$("#alertasContainer").addClass("siguiente");$("#mensajesHTML").css("display","inline-block");$("#alertasContainer").html(texto);tl.restart()}
function mostrarTemaCompletado(texto){$("#alertasContainer").addClass("completado");$("#mensajesHTML").css("display","inline-block");$("#alertasContainer").html(texto);tl.restart()}
function populateMenu(jsonob){let modulosbreak=[0,1,2,7,11,17,21,26];let consecutivo=0;for(let index=0;index<jsonob.Modulos.length;index++){for(let j=0;j<jsonob.Modulos[index]['Mod'+(index+1)].length;j++){id=consecutivo;if(modulosbreak.indexOf(j)!==-1){$("#temasContainer").append("<div id='"+(consecutivo+1)+"' onclick='llamarTema("+(consecutivo)+")' onmouseover='rollover("+(consecutivo+1)+")' onmouseout='rollout("+(consecutivo+1)+")' class='col-xs-12 tituloTemaMenu'>"+"<div class='col-xs-1' style='padding-top: 8px; padding-left:0px; padding-right:0px;'>"+"<a>"+"<i class='fas fa-circle menuIconStyle'></i>"+"</a>"+"</div>"+"<div class='col-xs-8' style='color:white; margin: 0px;padding-top: 7px; padding-left:0px;'>"+"<p class='reset' style='float: left; padding-top: 3px; padding-left: 0px; pointer-events:none; text-align:left'>"+jsonob.Modulos[index]['Mod'+(index+1)][j]+"</p>"+"</div>"+"</div>")}else{$("#temasContainer").append("<div id='"+(consecutivo+1)+"' style='padding-left: 30px;' onclick='llamarTema("+(consecutivo)+")' onmouseover='rollover("+(consecutivo+1)+")' onmouseout='rollout("+(consecutivo+1)+")' class='col-xs-12 tituloTemaMenu'>"+"<div class='col-xs-1' style='padding-top: 8px;'>"+"<a>"+"<i class='fas fa-circle menuIconStyle'></i>"+"</a>"+"</div>"+"<div class='col-xs-8' style='color:white; margin: 0px;padding-top: 7px; padding-left:0px;'>"+"<p class='reset' style='float: left; padding-top: 3px; padding-left: 0px; pointer-events:none; text-align:left'>"+jsonob.Modulos[index]['Mod'+(index+1)][j]+"</p>"+"</div>"+"</div>")}
consecutivo++;if(debug){console.log(jsonob.Modulos[index]['Mod'+(index+1)][j])}}}}
function habilitarEvals(nMod){for(let index=0;index<Evals.length;index++){if(Evals[index].Modulo==nMod){if($("#Evaluacion"+(nMod+1)).hasClass("menuTemaDisabled")){$("#Evaluacion"+(nMod+1)).removeClass("menuTemaDisabled").addClass("menuTemaDesbloqueado")}}}}
function rollover(id){}
function rollout(id){}
function llamarTema(id){ir(id);llamar_menuHTML()}
function llamarEval(id){var iframe=document.getElementById("Contenido");if(debug){console.log("temas/"+obj.NombreEval+".html")}
iframe.src="temas/"+obj.NombreEval+".html";terminado=!0;iframe.onload=function(){$('#div_contenido').fadeIn()};llamar_menuHTML()}
var getBrowserInfo=function(){var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return'IE '+(tem[1]||'')}
if(M[1]==='Chrome'){tem=ua.match(/\b(OPR|Edge)\/(\d+)/);if(tem!=null)return tem.slice(1).join(' ').replace('OPR','Opera')}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null)M.splice(1,1,tem[1]);return M.join(' ')};if(debug){console.log("el navegador usado y la version son");console.log(getBrowserInfo());console.log(getBrowserInfo().split(" ")[0])}
function initialize(){if(!detectarMovil()){setTimeout(inicializar,2000);setTimeout(function(){clearInterval(myVar)},1999);window.onresize()}else{$("#blocked").html("Este curso no es compatible con navegadores moviles, favor de lanzarlo en PC o Laptop. Error code: x00001");$("#coursebl").css("display","block")}}
function myTimer(){document.getElementById("loaderText").innerHTML="Cargando <br /> <br /> "+contador+"%";if(contador<100)
contador++}
function inicializar(myVar){$("#loader-wrappler").remove();window.clearInterval(myVar)
InitApi()}
function InitApi(){if(debug){console.log("------Inicializacion------")}
getAPI();IdentificarEstado();document.getElementById("menuHTML").style.height=(document.getElementById("div_contenido").style.height-30)+'px';$("#menuHTML").height($("#div_contenido").height()-30);$("#ultimoContainer").width($("#div_contenido").width()+3);let h=Math.max(document.documentElement.clientHeight,window.innerHeight||0);let diff=h-$("#content").height();$("#content").css("margin-top",((diff/2).toString()+"px"))}
function IdentificarEstado(){if(debug){console.log("------Identificado la Ejecucion del Curso------")}
if(String(URLactual).indexOf("http://localhost")==0||String(URLactual).indexOf("lumicmedia.com")>0||String(URLactual).indexOf("clientes.cdilearning.com")>0){leeLocal();ONLINE=!1}else{if(String(URLactual).indexOf("http")==0){leeOnline();ONLINE=!0;new_nswf_DoFSCommand("getParam","")}else{leeLocal();ONLINE=!1}}}
function initConfig(jsonob){if(debug){console.log("numero de modulos:"+jsonob.Modulos.length/2)}
let numModulos=jsonob.Modulos.length;let indexRutas=0;let index=0;for(let i=0;i<jsonob.Rutas.length;i++){for(var j=0;j<(jsonob.Rutas[i]["Rut"+(i+1)]).length;j++){Rutas.push((jsonob.Rutas[i]["Rut"+(i+1)])[j]);index++}}
Total=Rutas.length;TotalArchivos=Rutas.length;if(debug){console.log("Dato de las rutas: ");console.log(Rutas);console.log("json trak es:  "+jsonob.Trak)}
initbarra(jsonob);$("#NombreDelCurso").html(jsonob.NombreCurso);if(ULTIMO>1||(ULTIMO===1&&TRAK[0]==2)){mostrarUltimo()}}
function llamarRetros(){}
function actualizaTemasTerminados(){let text=currentPagina+"/"+PagTotal;actualizarProgressBarCDI();return $("#numTemasCompletados").html(text)}
function actualizarProgressBar(){}
function actualizarProgressBarCDI(){let progress=((currentPagina*100)/PagTotal);$("#progressBar").css("width",progress+"%");$("#percent").html(progress.toFixed(0)+"%")}
function leeLocal(){if(debug){console.log("lee local")}
var localStor=leeLocalStorage();if(localStor==undefined||localStor==""){if(debug){console.log("No existe un Informacion")}
obj=$.parseJSON(ConfigurationJson)}else{if(debug){console.log("Ya existe Informacion")}
obj=$.parseJSON(localStor)}
if(debug){console.log("Asignacion de valores");console.log(JSON.stringify(obj))}
setValues(obj);initConfig(obj);cargarPortada()}
function setValues(ob){ULTIMO=ob.Ultimo;Avance=ob.Avance;oportunidades=ob.Evaluaciones[0].MaxIntentos;intentoAct=ob.Evaluaciones[0].IntentoActual;SCORE=ob.Evaluaciones[0].CalActual;califMinima=ob.Evaluaciones[0].CalMinima;TRAK=ob.Trak;if(TRAK.length===0||TRAK===undefined||TRAK===null||TRAK===NaN){for(let i=0;i<ob.Pag.length;i++){TRAK.push(0)}}
Pag=ob.Pag;libre=ob.Libre;NombreModulos=ob.NombreModulos;Modulos=ob.Modulos;Evals=ob.Evaluaciones;for(let i=0;i<ob.Pag.length;i++){PagTotal+=parseInt(ob.Pag[i])}}
function setObject(){obj.Trak=TRAK;obj.Ultimo=ULTIMO;obj.Evaluaciones[0].CalActual=SCORE;obj.Evaluaciones[0].MaxIntentos=oportunidades;obj.Evaluaciones[0].IntentoActual=intentoAct;obj.Evaluaciones[0].CalMinima=califMinima;obj.Libre=libre;obj.Avance=Avance}
function leeLocalStorage(){var retorno;try{var nav=getBrowserInfo().split(" ")[0];if(nav=="IE"){if(debug){console.log("leyendo cookie")}
retorno=(document.cookie.indexOf('data=')===-1?'':("; "+document.cookie).split('; data=')[1].split(';')[0])}else{if(debug){console.log("leyendo LocalStorage")}
retorno=window.localStorage.getItem(NombreCurso)}}catch(e){console.log("error al leer local storage:"+e.text)}
return retorno}
function guardaLocalStorage(clave){try{var nav=getBrowserInfo().split(" ")[0];if(nav=="IE"){if(debug){console.log("se guarda en cookie")}
var expiration_date=new Date();expiration_date.setFullYear(expiration_date.getFullYear()+1);document.cookie="data="+JSON.stringify(clave)+"; expires="+expiration_date.toGMTString()}else{if(debug){console.log("se guarda en LocalStorage")}
window.localStorage.setItem(NombreCurso,JSON.stringify(clave))}}catch(e){console.log("no pudo guardar archivos en local storage:"+e.text)}}
function imprimirIframe(){if(debug){console.log("imprime")}
window.frames.Contenido.focus();window.frames.Contenido.print()}
function leeOnline(){if(debug){console.log("LEE ONLINE");console.log("regresoLMS "+regresoLMS)}
regresoLMS=ComunicacionLMS("leer");if(regresoLMS==""||regresoLMS==undefined){if(debug){console.log("suspent data vacio, generando json")}
obj=$.parseJSON(ConfigurationJson)}else{if(debug){console.log("suspend data diferente a vacio")}
var jsonObj=regresoLMS;obj=$.parseJSON(jsonObj)}
if(debug){console.log(obj)}
setValues(obj);initConfig(obj);cargarPortada()}
function guardarDatos(){setObject();if(ONLINE){if(debug){console.log("guardando datos online");console.log("json-generando")}
var jsonObj=JSON.stringify(obj);ComunicacionLMS("guardar",jsonObj)}else{if(debug){console.log("guardando datos local")}
guardaLocalStorage(obj)}}
function limpiarContenido(){if(debug){console.log("**********************limpiarContenido")}
let contenido=document.getElementById("Contenido");contenido.src="*"}
function ir(id){if(menu_open){llamar_menuHTML()}
if(debug){console.log("********",ULTIMO,id,TRAK[id]);console.log("**********************IR");console.log("ir "+id)}
limpiarContenido();let iframe=document.getElementById("Contenido");iframe.src=Rutas[id];iframe.onload=function(){$('#div_contenido').fadeIn()};_root.IDActual=id;recalcularPaginaActual(id);if(debug){console.log("IDActual: ",_root.IDActual," ULTIMO: ",_root.ULTIMO)}
if(canvasContenido){reset_navegacion(canvasContenido.timeline.position,canvasContenido.timeline.duration)}
actualizaTemasTerminados()}
function recalcularPaginaActual(newID){let nPag=1;for(let i=0;i<newID;i++){nPag+=parseInt(Pag[i])}
currentPagina=nPag}
function iniciar_tema(canvasTema){debugger
let reset=!0;try{let resp=obtenerFramePorPagina(_root.ULTIMO);if(debug){console.log("inicio_tema",_root.IDActual)}
getCanvas(canvasTema);if(canvasContenido.timeline.duration>1&&resp[1]==canvasContenido.timeline.duration){canvasContenido.gotoAndStop(resp[1]-1)}
if(TRAK[IDActual]<1){TRAK[IDActual]=1}
if(controlIrUltimo){if(debug){console.log("llendo a la ultima pagina desde reset_navegacion")}
console.log("Frame al que navegara: "+resp[1])
if(resp[0]===EvalID){EvalInProgress=!0}
if(!EvalInProgress){if(resp[1]>1){canvasContenido.gotoAndStop(resp[1]-1)}
reset_navegacion(resp[1]-1,canvasContenido.timeline.duration);reset=!1}
controlIrUltimo=!1}
if(controlAtras){if(debug){console.log("entro a control atras")}
let frame=canvasContenido.timeline.duration;if(resp[0]===(EvalID+1)){EvalInProgress=!0}
if(EvalInProgress==!1){if(canvasContenido.timeline.duration>1){canvasContenido.gotoAndPlay(frame-1)}}
controlAtras=!1}
if(_root.ULTIMO>=_root.currentPagina){habilitar_deshabilitar_btns(getBtnArray(btnSiguiente),"h","iniciar_tema")}
if(IDActual!==0){_root.ULTIMO=_root.currentPagina}
_root.Avance=_root.currentPagina>_root.Avance?_root.currentPagina:_root.Avance;guardarDatos();if(debug){console.log("fin inicio tema")}}catch(error){if(debug){console.warn("Error iniciando tema: "+error)}}
actualizar_menuHTML(TRAK);if(reset){reset_navegacion(canvasContenido.timeline.position,canvasContenido.timeline.duration)}}
function obtenerFramePorPagina(pagDestino){let sum=0;let antSum=0;for(let i=0;i<obj.Pag.length;i++){sum+=parseInt(obj.Pag[i]);if(pagDestino>=antSum&&pagDestino<=sum){let ret=[];ret[0]=i;ret[1]=pagDestino-antSum;return ret}
antSum=sum}}
function final_tema(){if(debug){console.log("*********************FINAL TEMA",_root.IDActual)}
if(TRAK[IDActual]<2){TRAK[IDActual]=2}
if(IDActual>0){_root.ULTIMO=_root.currentPagina}
_root.Avance=_root.currentPagina>_root.Avance?_root.currentPagina:_root.Avance;if(debug){console.log(_root.ULTIMO,_root.IDActual,TRAK,TRAK[_root.IDActual])}
habilitar_deshabilitar_btns(getBtnArray(btnSiguiente),"h","final_tema")
actualizar_menuHTML(TRAK);guardarDatos();actualizarProgressBar();if(banderillas){alertas(2,"Tema Completo. Haz Clic en Siguiente para continuar.")}
console.log(" Curso Completado "+cursoCompletado())}
function retrasar_final_tema(seconds){if(debug){console.log("*********************FINAL TEMA",_root.IDActual+" retrasado por "+seconds)}
if(typeof seconds==='number'){return}
seconds=seconds>0?seconds:1;setTimeout(final_tema,seconds*1000)}
function retrasar_habilitar_siguiente(seconds){if(debug){console.log("-habilitar siguiente retrasado por "+seconds)}
if(typeof seconds==='number'){return}
if(banderillas){alertas(1,"Da clic en siguiente para continuar.")}
seconds=seconds>0?seconds:1;setTimeout(habilitarSiguiente,seconds*1000)}
function glosarioX(){var iframe=document.getElementById("glosario");iframe.src="temas/"+obj.NombreIntro+".html";var g=document.getElementById('btnGlos');g.click()}
function irUltimo(){let resp=obtenerFramePorPagina(ULTIMO);ir(resp[0]);controlIrUltimo=!0;cerrarUltimo();currentPagina=ULTIMO;actualizaTemasTerminados()}
function cerrarUltimo(){$("#ultimoContainer").css("display","none")}
function mostrarUltimo(){$("#ultimoContainer").css("display","block");TweenLite.from($("#ultimoContainer"),1,{opacity:0})}
function Cierra(){$('#Palabra').hide()}
window.Cargar_Sim=function(URLS,finalizoS,LASTMCS){if(debug){console.log("cargar Sim")}
setEdo_botones();this.habilitar_deshabilitar_btns(this.getBtnArray(this.btnAtras,this.btnSiguiente,this.btnCerrar),"d","Cargar_Sim");estadoSim=!0;$('#div_contenido').hide();$('#div_sim').fadeIn();var simulacion=document.getElementById("sim");simulacion.src=URLS;if(debug){console.log("Fin cargar Sim")}
LastMCVid=LASTMCS;if(finalizoS){VidLast=!0}}
function simFinalizada(){if(debug){console.log("termina la simulacion")}
canvasBarra.habilitar_cerrar()}
window.cargar_video=function(URLS,finalizoS,LASTMCS){if(debug){console.log("cargar video")}
setEdo_botones();this.habilitar_deshabilitar_btns(this.getBtnArray(this.btnAtras,this.btnSiguiente,this.btnCerrar),"d","cargar_video");LastMCVid=LASTMCS;estadoSim=!0;$('#div_contenido').hide();$('#div_vid').fadeIn();var simulacion=document.getElementById("vid");simulacion.src=URLS;simulacion.onended=function(){if(debug){console.log("finalizo? desde start "+finalizoS)}
this.habilitar_deshabilitar_btns(getBtnArray(this.btnCerrar),"h","Cargar_Sim");if(finalizoS){VidLast=!0}};if(debug){console.log("Fin cargar video")}}
function Cierra_Sim(){if(estadoSim==!1){llamarAlertas("Exit")}else{if(debug){console.log("cierra sim")}
$('#div_sim').hide();$('#div_vid').hide();$('#div_contenido').fadeIn();limpiarSim();canvasBarra.habilitar_atras();canvasBarra.cambio_cerrar(0);getEdo_botones();if(VidLast){if(LastMCVid){siguiente_verde();final_tema()}else{siguiente_naranja()}}
LastMCVid=!1;VidLast=!1}}
function checarTerminacion(){var creditosActuales=0;var creditosMinimos=TRAK.length*2;for(var i=0;i<TRAK.length;i++){creditosActuales+=TRAK[i]}
if(debug){console.log("creditosMinimos: "+creditosMinimos+"\ncreditosActuales: "+creditosActuales+"")}
if((creditosMinimos==creditosActuales)){if(debug){console.log("El curso ya fue terminado, Evaluacion Desbloqueada")}
canvasBarra.habilitar_eval();termino=!0}else{if(!backdoor){if(debug){console.log("un no se ve todo el curso, Evaluacion Bloqueada")}
canvasBarra.deshabilitar_eval()}
if(debug){console.log("el backdoor esta activo, Evaluacion Desbloqueada")}
canvasBarra.habilitar_eval()}}
function limpiarSim(){if(debug){console.log("limpiarSim")}
estadoSim=!1;var sim=document.getElementById("sim");sim.src="";var vide=document.getElementById("vid");vide.src=""}
function getCanvas(valor){if(debug){console.log("Obtener Canvas")}
canvasContenido=valor}
function llamar_menuHTML(){if(!bussy){if(!menu_open){$("#menuHTML").addClass("menu-open");TweenLite.from($("#menuHTML"),0.3,{opacity:0,top:'1400px'});this.menu_open=!0;setMenuBlur(!0);let stateBackup=[EdoBtns.btnSiguiente,EdoBtns.btnAtras];habilitar_deshabilitar_btns(getBtnArray(btnAtras,btnSiguiente),"d","llamar_menu");EdoBtns.btnSiguiente=stateBackup[0];EdoBtns.btnAtras=stateBackup[1]}else{TweenLite.to($("#menuHTML"),0.3,{opacity:0,top:'1400px'});bussy=!1;setMenuBlur(!1);let btnArray=new Array();if(EdoBtns.btnAtras&&currentPagina>1){btnArray.push(btnAtras)}
if(EdoBtns.btnSiguiente){btnArray.push(btnSiguiente)}
habilitar_deshabilitar_btns(btnArray,"h","llamar_menu");setTimeout(function(){this.menu_open=!1;$("#menuHTML").removeClass("menu-open");$("#btnMenu").css("pointer-events","all");TweenLite.to($("#menuHTML"),0.01,{opacity:1,top:"0px"});bussy=!1},300)}}
window.onresize();actualizar_menuHTML(TRAK);limpiarSim()}
function setMenuBlur(action){try{let iframe=document.getElementById("Contenido");var element=iframe.contentWindow.document.querySelector('canvas');let filterVal='blur(0px)';switch(action){case true:filterVal='blur(5px)';break;default:filterVal="";break}
element.style.filter=filterVal}catch(error){console.log("Error tratando de aplicar blur. Error: "+error)}}
function llamar_Portada(){$('#div_sim').hide();$('#div_vid').hide();$('#div_contenido').fadeIn();var portada=document.getElementById("Contenido");portada.src="temas/"+obj.NombreIntro+".html";limpiarSim()}
function preload(){$('#div_loader').fadeIn();$('#div_contenido').fadeIn()}
function cargarPortada(){if(debug){console.log("cargar portada")}
var iframe=document.getElementById("Contenido");if(debug){console.log("temas/"+obj.NombreIntro+".html")}
$('#div_sim').hide();$('#div_vid').hide();limpiarSim();ir(0)}
function actualizarMenu(){var cont=0;var tema=0;if(debug){console.log("Actualizar menu "+TRAK)}
for(var i=0;i<Total;i++){tema=TRAK[i];if(debug){console.log("ESTADO DE TEMAS "+TRAK[i],tema)}
if(tema==1){if(debug){console.log(i,1)}
canvasMenu.cambioEdo(i,1,!0)}else{if(tema==2){cont++;if(debug){console.log(i,2,cont)}
canvasMenu.cambioEdo(i,2,!0)}else{if(debug){console.log("no entro a ninguno de los anteriores "+i)}
canvasMenu.cambioEdo(i,0,!1)}}
if(tema==2&&TRAK[i+1]==0){canvasMenu.cambioEdo((i+1),0,!0);break}}
if((cont>=Total&&oportunidades<3)||backdoor){this.habilitar_deshabilitar_btns(getBtnArray(btnEval),"h","actualizar_menu")}else{this.habilitar_deshabilitar_btns(getBtnArray(btnEval),"d","actualizar_menu");if(debug){console.log("No se ha completado el curso",cont,Total,terminado)}}}
function saltar_intro(){llamar_menu();cargarBarra();$('#div_contenido').hide();if(_root.ULTIMO>0){}}
window.onkeyup=function(event){if(event.keyCode==17){console.log("CONTROL UP");validar_control=!1}
if(event.keyCode==16){console.log("SHIFT UP");validar_shift=!1}}
window.onkeydown=function(event){if(event.keyCode==17){validar_control=!0}
if(event.keyCode==16&&validar_control==!0){validar_shift=!0}
if(event.keyCode==32&&validar_control==!0&&validar_shift==!0){llamarAlertas("backdoor")}}
function validarbackdoor(){if(backdoor==!1){llamarAlertas("desbloqueado");console.log("el backdoor esta:"+backdoor)}else{llamarAlertas("bloqueado");console.log("el backdoor esta:"+backdoor)}}
function borrarprogreso(){console.log("borrando");obj=$.parseJSON(ConfigurationJson);setValues(obj);initConfig(obj);guardarDatos();actualizarMenu();cargarBarra();llamar_menu()}
function getPreguntas(){console.log("NumPreguntas desde start:"+canvasContenido.mc_eval.timeline.duration);NumPreguntas=canvasContenido.mc_eval.timeline.duration;console.log("el numero de preguntas es:"+NumPreguntas)}
function initbarra(jsonob){btnAtras=document.getElementById("btnAtras");btnSiguiente=document.getElementById("btnSiguiente");btnMenu=document.getElementById("btnMenu");btnEval=document.getElementById("btnEval");btnHome=document.getElementById("btnHome");btnCerrar=document.getElementById("btnCerrar");habilitar_deshabilitar_btns(getBtnArray(btnSiguiente,btnAtras),"d","initbarra");if(!cursoCompletado()){}
actualizaTemasTerminados();actualizarProgressBar(70);populateMenu(jsonob);inicializaMensajes()}
function home(){$('#div_contenido').fadeIn();llamar_Portada()}
function cerrar(){Cierra_Sim()}
function habilitar_deshabilitar_btns(arraybtn,action,functionName){if(action!=="d"&&action!=="h"){if(debug){console.error("Funcion habilitar_deshabilitar_btns:"+"No se enviaron los parametros de habilitar o habilitar correctamente."+" Llamdo desde funcion: "+functionName)}
return}
if(arraybtn.length==0){if(debug){console.error("Funcion habilitar_deshabilitar_btns:"+"Se enviaron 0 elementos en el array de botones. "+"Llamdo desde funcion: "+functionName)}
return}
name="disabledButton";for(let index=0;index<arraybtn.length;index++){if(action==="d"){$("#"+arraybtn[index].id.toString()).addClass(name);EdoBtns[arraybtn[index].id.toString()]=!1}else{$("#"+arraybtn[index].id.toString()).removeClass(name);EdoBtns[arraybtn[index].id.toString()]=!0}}
if(debug){console.log("Nuevo edo de botones: ")}
if(debug){console.log(this.EdoBtns)}}
function habilitarSiguiente(){habilitar_deshabilitar_btns(getBtnArray(btnSiguiente),"h","habilitarSiguiente");if(banderillas){alertas(1,"Da clic en siguiente para continuar.")}}
function habilitarAtras(){habilitar_deshabilitar_btns(getBtnArray(btnAtras),"h","habilitarAtras")}
function deshabilitarSiguiente(){habilitar_deshabilitar_btns(getBtnArray(btnSiguiente),"d","deshabilitarSiguiente")}
function deshabilitarAtras(){habilitar_deshabilitar_btns(getBtnArray(btnAtras),"d","deshabilitaratras")}
function habilitar_deshabilitarBarra(action){switch(action){case "d":habilitar_deshabilitar_btns(this.getBtnArray(this.btnAtras,this.btnSiguiente,this.btnMenu),"d","habilitar_deshabilitarBarra");break;case "h":habilitar_deshabilitar_btns(this.getBtnArray(this.btnAtras,this.btnSiguiente,this.btnMenu),"h","habilitar_deshabilitarBarra");break;default:habilitar_deshabilitar_btns(this.getBtnArray(this.btnAtras,this.btnSiguiente,this.btnMenu),"d","habilitar_deshabilitarBarra");break}}
function actualizarEdoBotones(){this.EdoBtns.btnAtras=this.btnAtras.className.indexOf("disabledButton")>=0?!1:!0;this.EdoBtns.btnSiguiente=this.btnSiguiente.className.indexOf("disabledButton")>=0?!1:!0;this.EdoBtns.btnMenu=this.btnMenu.className.indexOf("disabledButton")>=0?!1:!0}
function getBtnArray(e1,e2,e3,e4,e5,e6){let paramArray=[e1,e2,e3,e4,e5,e6];this.btnArray=[];for(let i=0;i<5;i++){if(paramArray[i]!=null&&paramArray[i]!=undefined){this.btnArray.push(paramArray[i])}}
return this.btnArray}
function bloquear_barra(action){switch(action){case "d":if(this.EdoBtns.barra===!1)
return;habilitar_deshabilitar_btns(getBtnArray(this.btnAtras,this.btnSiguiente,this.btnEval,this.btnHome,this.btnCerrar,this.btnMenu),action,"bloquear_barra");this.EdoBtns.barra=!1;break;case "h":if(this.EdoBtns.barra===!0)
return;habilitar_deshabilitar_btns(getBtnArray(this.btnAtras,this.btnSiguiente,this.btnEval,this.btnHome,this.btnCerrar,this.btnMenu),action,"bloquear_barra");this.EdoBtns.barra=!1;this.EdoBtns.barra=!0;break;default:if(debug){console.warn("El parametro de entrada para bloquear/Desbloquer barra es incorrecto, "+"solo se acepta 'd' para deshabilitar o 'h' para habilitar.")}
return}}
function habilitar_deshabilitar_eval(action){if(this.libre){habilitar_deshabilitar_btns(getBtnArray(btnEval),"d","habilitar_deshabilitar_eval")}
switch(action){case "d":if(this.EdoBtns.btnEval===!1)
return;habilitar_deshabilitar_btns(getBtnArray(btnEval),"d","habilitar_deshabilitar_eval");break;case "d":if(this.EdoBtns.btnEval===!0)
return;habilitar_deshabilitar_btns(getBtnArray(btnEval),"h","habilitar_deshabilitar_eval");break;default:break}}
function partialdisabled(){$("#btnSiguiente").attr("disabled")=!0;setTimeout(function(){$("#btnSiguiente").attr("disabled")=!1},100)}
function siguiente_frame(){if(!bloqueoSiguiente){bloqueoSiguiente=!0;habilitar_deshabilitar_btns(getBtnArray(btnSiguiente));if($('#div_sim').show()){$('#div_sim').hide();limpiarSim()}
if(!EvalInProgress){if(pagActual<numPags-1){currentPagina+=1;ULTIMO=currentPagina;paginaSiguiente()}
else{siguienteTema()}}else{siguienteTema();EvalInProgress=!1}
_root.Avance=_root.currentPagina>_root.Avance?_root.currentPagina:_root.Avance;actualizaTemasTerminados();setTimeout(function(){bloqueoSiguiente=!1},100)}}
function anterior_frame(){if(!EvalInProgress){if(pagActual>0){canvasContenido.gotoAndStop(pagActual-1);currentPagina-=1;ULTIMO=currentPagina}
else{if(IDActual>0){temaAnterior()}}}else{temaAnterior();EvalInProgress=!1}
reset_navegacion(canvasContenido.timeline.position,canvasContenido.timeline.duration);actualizaTemasTerminados()}
function paginaSiguiente(){pagActual+=1;reset_navegacion(pagActual,canvasContenido.timeline.duration);canvasContenido.gotoAndStop(pagActual);guardarDatos();actualizaTemasTerminados()}
function paginaAnterior(){if(this.libre)
this.habilitar_deshabilitar_btns(getBtnArray(this.btnAtras,btnSiguiente),"h","paginaAnterior");if((pagActual-1)===0&&IDActual===0){this.habilitar_deshabilitar_btns(getBtnArray(this.btnAtras),"d","paginaAnterior")}
pagActual-=1;canvasContenido.gotoAndStop(pagActual);reset_navegacion(canvasContenido.timeline.position,canvasContenido.timeline.duration);actualizaTemasTerminados()}
function siguienteTema(){ir(_root.IDActual+1)}
function temaAnterior(id){ir(IDActual-1);controlAtras=!0;currentPagina=ULTIMO-1;actualizaTemasTerminados()}
function actualizarNavegacion(currentPage,totalPages){pagActual=currentPage;numPags=totalPages}
var sumaPag=0;function reset_navegacion(pagin,cantPag){pagin=pagin<0?0:pagin;stopAlertas();pagActual=pagin;numPags=cantPag;this.habilitar_deshabilitar_btns(getBtnArray(this.btnSiguiente),"d","reset_navegacion");if(pagActual==0&&IDActual==0){this.habilitar_deshabilitar_btns(getBtnArray(this.btnAtras),"d","reset_navegacion")}else{this.habilitar_deshabilitar_btns(getBtnArray(this.btnAtras),"h","reset_navegacion")}
if(ULTIMO>currentPagina||libre||Avance>ULTIMO){this.habilitar_deshabilitar_btns(getBtnArray(this.btnSiguiente),"h","reset_navegacion")}
if(backdoor){this.habilitar_deshabilitar_btns(getBtnArray(this.btnAtras,this.btnSiguiente),"h","reset_navegacion")}
guardarDatos()}
function cursoCompletado(){let completo=!0;for(let index=0;index<this.TRAK.length;index++){if(TRAK[index]<2){completo=!1;break}}
return completo}
function actualizar_menuHTML(TrakCurso){for(let i=0;i<TrakCurso.length;i++){var element=$("#"+i).find("i");var tema=$("#"+(i+1));actualizarIndicadores(tema,TrakCurso[i]);if(i>0&&TrakCurso[i-1]>=2||Temaslibre){if(debug){console.log("desbloqueo Tema: "+i)}
desbloquearTema(tema)}else{if(i>0){if(debug){console.log("tema +"+i+"bloqueado")}
bloquearTema(tema)}}
if(TRAK[tema.attr("id")-1]==0){tema.addClass("tituloTemaMenuNoIniciado")}else{tema.removeClass("tituloTemaMenuNoIniciado")}}
function desbloquearTema(elemento){elemento.removeClass("menuTemaDisabled");elemento.addClass("menuTemaDesbloqueado")}
function bloquearTema(elemento){elemento.addClass("menuTemaDisabled")}
function actualizarIndicadores(elemento,status){let i=elemento.find("i");switch(status){case 0:break;case 1:i.removeClass("menuIconStyle").addClass("menuIconStyleIniciado");break;case 2:i.removeClass("menuIconStyleIniciado").addClass("menuIconStyleCompletado");break}}
function actualizarEstatusModulo(tema){let arreglo=[];let numModulo=getModuloFromTema(tema);let Modulo=getLenghtModulo(numModulo);for(let i=Modulo.inicio;i<Modulo.final;i++){arreglo.push(TRAK[i])}
if(arreglo.indexOf(0)===-1&&arreglo.indexOf(1)===-1){if(debug){console.log("Modulo Completado Marcando estado completado")}
actualizarIndicadores($("#Modulo"+numModulo),2);habilitarEvals(numModulo);$("#Modulo"+numModulo).removeClass("tituloTemaMenuNoIniciado")}else if(arreglo.indexOf(1)!==-1||arreglo.indexOf(2)!==-1){actualizarIndicadores($("#Modulo"+numModulo),1);$("#Modulo"+numModulo).removeClass("tituloTemaMenuNoIniciado")}
arreglo=[]}
function getLenghtModulo(numModulo){let suma=0;for(let t=0;t<=(numModulo-1);t++){suma+=(obj.Modulos[t]["Mod"+(t+1)].length)}
let resp=[suma,obj.Modulos[numModulo-1]["Mod"+numModulo].length];let datos={inicio:(suma-obj.Modulos[numModulo-1]["Mod"+numModulo].length),final:suma,nModulo:numModulo}
return datos}
function getModuloFromTema(tema){let suma=0;let nModulo=1;for(let index=1;index<=Modulos.length;index++){suma+=(Modulos[(index-1)]["Mod"+index].length);if((tema>=(suma-Modulos[(index-1)]["Mod"+index].length))&&(tema<suma)){nModulo=index;break}}
return nModulo}}